{% extends "base.html" %}

{% block title %}Job Preferences - LinkedIn Auto-Applicant{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 mb-4">
        <h2>Job Preferences</h2>
        <p class="text-muted">Configure what types of jobs you want to apply for.</p>
    </div>
</div>

<form method="POST">
    <div class="row">
        <div class="col-md-8">
            <!-- Job Search Criteria -->
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-search"></i> Job Search Criteria</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label required">Job Titles (comma-separated)</label>
                        <input type="text" class="form-control" name="job_titles"
                               value="{{ preferences.job_titles | join(', ') }}"
                               placeholder="Software Engineer, Python Developer, Data Scientist" required>
                        <div class="form-text">Enter job titles you're interested in</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Locations (comma-separated)</label>
                        <input type="text" class="form-control" name="locations"
                               value="{{ preferences.locations | join(', ') }}"
                               placeholder="New York, San Francisco, Remote">
                        <div class="form-text">Leave empty for any location</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Keywords (comma-separated)</label>
                        <input type="text" class="form-control" name="keywords"
                               value="{{ preferences.keywords | join(', ') }}"
                               placeholder="React, AWS, Machine Learning">
                        <div class="form-text">Optional keywords to include in search</div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-funnel"></i> Filters</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Remote Preference</label>
                            <select class="form-select" name="remote_preference">
                                <option value="Any" {{ 'selected' if preferences.remote_preference == 'Any' }}>Any</option>
                                <option value="Remote" {{ 'selected' if preferences.remote_preference == 'Remote' }}>Remote</option>
                                <option value="On-site" {{ 'selected' if preferences.remote_preference == 'On-site' }}>On-site</option>
                                <option value="Hybrid" {{ 'selected' if preferences.remote_preference == 'Hybrid' }}>Hybrid</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Date Posted</label>
                            <select class="form-select" name="date_posted">
                                <option value="Past 24 hours" {{ 'selected' if preferences.date_posted == 'Past 24 hours' }}>Past 24 hours</option>
                                <option value="Past week" {{ 'selected' if preferences.date_posted == 'Past week' }}>Past week</option>
                                <option value="Past month" {{ 'selected' if preferences.date_posted == 'Past month' }}>Past month</option>
                                <option value="Any time" {{ 'selected' if preferences.date_posted == 'Any time' }}>Any time</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Experience Levels</label>
                        <div class="row">
                            {% set exp_levels = ['Internship', 'Entry level', 'Associate', 'Mid-Senior level', 'Director', 'Executive'] %}
                            {% for level in exp_levels %}
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="experience_levels"
                                           value="{{ level }}" id="exp_{{ loop.index }}"
                                           {{ 'checked' if level in preferences.experience_levels }}>
                                    <label class="form-check-label" for="exp_{{ loop.index }}">{{ level }}</label>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Job Types</label>
                        <div class="row">
                            {% set job_types = ['Full-time', 'Part-time', 'Contract', 'Temporary', 'Internship'] %}
                            {% for jt in job_types %}
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="job_types"
                                           value="{{ jt }}" id="jt_{{ loop.index }}"
                                           {{ 'checked' if jt in preferences.job_types }}>
                                    <label class="form-check-label" for="jt_{{ loop.index }}">{{ jt }}</label>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Exclusions -->
            <div class="card mb-4">
                <div class="card-header bg-white">
                    <h5 class="mb-0"><i class="bi bi-x-circle"></i> Exclusions</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Excluded Companies (comma-separated)</label>
                        <input type="text" class="form-control" name="excluded_companies"
                               value="{{ preferences.excluded_companies | join(', ') }}"
                               placeholder="Company A, Company B">
                        <div class="form-text">Companies you don't want to apply to</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Excluded Keywords (comma-separated)</label>
                        <input type="text" class="form-control" name="excluded_keywords"
                               value="{{ preferences.excluded_keywords | join(', ') }}"
                               placeholder="Senior, Lead, Manager">
                        <div class="form-text">Skip jobs with these words in the title</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-md-4">
            <div class="sidebar">
                <!-- Easy Apply Toggle -->
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="bi bi-lightning"></i> Easy Apply</h5>
                    </div>
                    <div class="card-body">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="easy_apply_only"
                                   id="easy_apply" {{ 'checked' if preferences.easy_apply_only }}>
                            <label class="form-check-label" for="easy_apply">
                                <strong>Easy Apply Only</strong>
                            </label>
                        </div>
                        <p class="text-muted small mt-2 mb-0">
                            Only apply to jobs with LinkedIn's Easy Apply feature. Recommended for automation.
                        </p>
                    </div>
                </div>

                <!-- Summary -->
                <div class="card mb-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="bi bi-info-circle"></i> Current Settings</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2">
                                <i class="bi bi-search text-primary"></i>
                                <strong>{{ preferences.job_titles | length }}</strong> job titles
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-geo-alt text-primary"></i>
                                <strong>{{ preferences.locations | length or 'Any' }}</strong> locations
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-briefcase text-primary"></i>
                                <strong>{{ preferences.experience_levels | length or 'Any' }}</strong> experience levels
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-x-circle text-danger"></i>
                                <strong>{{ preferences.excluded_companies | length }}</strong> excluded companies
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Save Button -->
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-check-lg"></i> Save Preferences
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>
{% endblock %}
